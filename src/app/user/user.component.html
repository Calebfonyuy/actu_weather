<ul class="nav">
	<li class="nav-item">
		<span class="font-weight-bold text-uppercase">{{ user.name }}</span>
	</li>
	<li class="nav-item ml-3 btn-link" (click)='logout()'>
		Logout
	</li>
	<li class="nav-item ml-3" (click)='toggleMenu()'>
		<span class="shadow h1 fa fa-align-justify" *ngIf="!showmenu"></span>
		<span class="shadow h1 fa fa-server" *ngIf="showmenu"></span>
	</li>
</ul>

<div class="col-5 ml-auto bg-light" id="main-div" *ngIf="showmenu">
	<div class="container-fluid p-3">
		<div class="row">
			<div class="col-2">
				<div class="m-1">
					<img src="" alt="IMAGE">
				</div>
				<div class="m-1">
					<span class="btn-link">Change</span>
				</div>
			</div>
			<div class="col-9 ml-auto">
				<div class="font-weight-bold text-uppercase">
					{{ user.name }} {{ user.surname }}
				</div>
				<div class="">
					{{ user.sex }}
				</div>
				<div class="">
					Born on <span class="font-weight-bold">{{ user.birthday.toDateString() }}</span>
				</div>
				<div class="" *ngIf="user.active_address">
					Currently at <span class="font-weight-bold">{{ user.active_address.getTown() }}</span>
				</div>
			</div>
			<div class="col-12">
				<button class="m-1 btn btn-info" (click)='switchMode()'>Modify Info</button>
			</div>
			<div class="col-12 mt-4" *ngIf='!editing'>
				<div class="col-12 row border border-default">
					<div class="col-8">
						<legend>Address</legend>
					</div>
					<div class="col-4 text-right">
						<span class="btn fa fa-plus" (click)='toggleAddAddr()'></span>
					</div>
				</div>

				<ul *ngFor="let address of user.address; index as i">
					<li *ngIf='address == user.active_address' class="font-weight-bold">
						{{ address.getTown() }} <span class="fa fa-check"></span>
					</li>
					<li *ngIf='address != user.active_address' class="btn-link" (click)="changAddress(i)">{{ address.getTown() }}</li>
				</ul>
			</div>
		</div>
		<div class="row" *ngIf='editing'>
			<form class="form col-12 p-0 m-0" action="#" method="get" (submit)="updateUser()">
				<div class="text-center font-weight-bold mt-2 mb-1">
					Update Account Information
				</div>
				<div class="input-group">
					<label class="col-12" for="name">Name</label>
					<input type="text" [(ngModel)]="name" name="name" id="name" class="form-control" autocomplete="off">
				</div>
				<div class="input-group">
					<label class="col-12" for="surname">Surname</label>
					<input type="text" [(ngModel)]="surname" name="surname" id="surname" class="form-control" autocomplete="off">
				</div>
				<div class="input-group">
					<label class="col-12" for="birthday">Birthday</label>
					<input type="date" [(ngModel)]="birthday" name="birthday" id="birthday" class="form-control">
				</div>
				<div class="input-group mt-1 row">
					<label class="col-2">Gender</label>
					<div class="col-10 row">
						<div class="col-6 m-auto row">
							<div class="col-1">
								<input type="radio" [(ngModel)]="sex" name="sex" id="masculin" value="Masculine">
							</div>
							<div class="col-1">
								<label for="masculin">Masculin</label>
							</div>
						</div>
						<div class="col-6 m-auto row">
							<div class="col-1">
								<input type="radio" [(ngModel)]="sex" name="sex" id="feminin" value="Feminine">
							</div>
							<div class="col-1">
								<label for="feminin">Feminin</label>
							</div>
						</div>
					</div>
				</div>
				<div class="input-group">
					<label class="col-12" for="username">Username</label>
					<input type="text" [(ngModel)]="username" name="username" id="username" class="form-control" autocomplete="off">
				</div>
				<div class="input-group">
					<label class="col-12" for="password">Password</label>
					<input type="password" [(ngModel)]="password" name="password" id="password" class="form-control" autocomplete="off">
				</div>
				<div class="input-group">
					<label class="col-12" for="password">Confirm Password</label>
					<input type="password" [(ngModel)]="password2" name="password2" id="password2" class="form-control" autocomplete="off">
				</div>
				<div class="input-group mt-3 row">
					<div class="col-5 m-auto">
						<button type="reset" name="reset" class="btn btn-danger">Cancel</button>
					</div>
					<div class="col-6">
						<button type="submit" name="submit" class="btn btn-success">Update</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>

<div class="container-fluid border">
	<form *ngIf='add_addr' class="form p-3 bg-light border border-success text-left"
			action="#" method="get" id="address-form">
		<legend>New Address</legend>
		<div class="input-group row">
			<div class="col-3">
				<label for="naddr">Town</label>
			</div>
			<div class="col-9 m-auto">
				<input type="text" [(ngModel)]="new_address.town" name="newTown" placeholder="Name of Town">
			</div>
			<div class="col-12 m-auto">
				<app-osmap (emit_position)="addAddress($event)"></app-osmap>
			</div>
		</div>
		<div class="input-group row">
			<div class="col-5 m-auto">
				<button type="reset" class="btn btn-danger w-100" (click)='toggleAddAddr()'>Cancel</button>
			</div>
			<div class="col-5 m-auto">
				<button type="submit" class="btn btn-success w-100" (click)='addUserAddress()'>Add</button>
			</div>
		</div>
	</form>
</div>
